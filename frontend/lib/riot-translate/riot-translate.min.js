!function(t,i){"function"==typeof define&&define.amd?define(["exports","riot"],function(e,n){i(t.translate=e,n)}):"object"==typeof exports?i(exports,window.riot):i(t.translate={},t.riot)}(this,function(t,i){var e="en";function n(){this._entities={},this._default=e,this._language=this._default;var t=i.observable();this.exceptions=[],this.on=t.on,this.off=t.off,this.trigger=t.trigger,this.on("lang",this.setLanguage)}n.prototype.dictionary=function(t){this._entities=t},n.prototype.defaultLanguage=function(t){this._default=t},n.prototype.apply=function(t,i){var e,n;function s(t,i,e,n){n=n||"",i=i||{},e=e||0;var a,o=t&&!t.length,r=o?Object.keys(t).length:0;if(o&&r>0)for(a in t)n.split(".").length>e&&(n=n.split(".").splice(0,e).join(".")),n=0==e?a:n+"."+a,i=s(t[a],i,e+1,n);else i[n]=t;return i}if(this._entities[this._language]||(e=t),!e)if((n=s(this._entities[this._language]))[t])e=n[t];else{var a='The phrase "'+t+'" was not found in the dictionary';this.exceptions.includes(a)||this.exceptions.push(a),e=t}if(i){var o,r=s(i);for(o in r)e=e.replace(new RegExp("{"+o+"}","g"),r[o])}return e},n.prototype.setLanguage=function(t){this._language=t||this._default,this.trigger("update")},n.prototype.getLanguage=function(){return this._language};var s,a=new n;for(s in a)t[s]=a[s];i.mixin("translate",{translate:t}),i.tag2("translate",'<span ref="original"><yield></yield></span>','translate,[riot-tag="translate"],[data-is="translate"]{ display: inline; }span[ref="original"]{ display: none; }',"",function(t){this.mixin("translate"),this.translate.on("update",function(){this.update()}.bind(this)),this.on("mount",function(){this.hasRefs=void 0!=this.refs,this.apply()}),this.on("update",function(){this.apply()}),this.apply=function(){var t=this.hasRefs?this.refs:this,i=this.translate.apply(t.original.innerHTML);for(var e in this.opts)i=i.replace("{"+e.replace(/([A-Z])/g,"-$1").toLowerCase()+"}",'<span ref="'+e+'">'+this.opts[e]+"</span>");for(var n=this.root;n.hasChildNodes();)n.removeChild(n.firstChild);n.innerHTML=i}})});
